# Задача 1: Библиотека OpenMP

## Характеристики вычислительной машины
- Процессор — AMD Ryzen 5 5500U 2.1 GHz
- Оперативная память — 16 Gb 3200 MHz
- Операционная система — Ubuntu 22.04.4 LTS
Под временем работы подразумевается время выполнения функции `approximate` т.к. именно она выполняет всю
работу и подсчёты. Время для аллокации массивов и замера абсолютной ошибки не учитываются во время работы.

## Численный эксперимент
В данном эксперименте я бы хотел продемонстрировать изменение времени работы алгоритма для **фиксированного количества потоков** при разных **размерах блока** и **размерах сетки**.

Эксперимент будет проводиться на следующих функциях:
1. $f_1(x, y) = 52$
2. $f_2(x, y) = 5 x^3 + 2 y^3$
3. $f_3(x, y) = 1 / sin(x y)$

Данные функции выбраны не случайно:
1. Константа
2. Непрерывная функция
3. Тригонометрическая функция

*Замечание* `eps=0.01` для каждого эксперимента

### Вывод для функции $f_1(x, y) = 52$

**1 поток**
| $net size$      | 100                       | 300                       | 500                      | 1000                       | 
|-----------------|--------------------------|--------------------------|--------------------------|---------------------------|
| $blockSize = 1$ | $0.777124$ | $5.409178$ | $15.332232$ | $59.880531$  | 
| $blockSize = 8$ | $0.346086$  | $2.648277$ | $7.777306$ | $36.841484$ | 
| $blockSize = 16$ | $0.348579$  | $2.687088$  | $7.916689$  | $35.985829$  |
| $blockSize = 32$ | $0.322078$ | $2.491353$ | $7.181067$ | $29.646095$  | 
| $blockSize = 64$ | $0.308752$  | $2.421826$ | $6.848969$ | $28.008791$ | 

---
**4 потока**
| $net size$      | 100                       | 300                       | 500                      | 1000                       | 
|-----------------|--------------------------|--------------------------|--------------------------|---------------------------|
| $blockSize = 1$ | $0.894705$ | $3.641493$ | $8.265760$ | $25.441929$ |
| $blockSize = 8$ | $0.198110$ | $1.009650$ | $2.742541$ | $11.719131$ |
| $blockSize = 16$ | $0.192041$ | $0.956334$ | $2.547898$ | $10.864231$ |
| $blockSize = 32$ | $0.216333$ | $1.036526$ | $2.454634$ | $9.837796$ |
| $blockSize = 64$ | $0.271639$ | $1.273764$ | $3.792636$ | $10.280286$ |

---
**8 потоков**
| $net size$      | 100                       | 300                       | 500                      | 1000                       | 
|-----------------|--------------------------|--------------------------|--------------------------|---------------------------|
| $blockSize = 1$ | $1.098247$ | $3.868161$ | $7.832718$ | $23.272780$ |
| $blockSize = 8$ | $0.229789$ | $1.020838$ | $2.414500$ | $9.438106$ |
| $blockSize = 16$ | $0.203844$ | $0.971098$ | $2.284508$ | $9.162093$ |
| $blockSize = 32$ | $0.270550$ | $1.068829$ | $2.322404$ | $8.384048$ |
| $blockSize = 64$ | $0.388282$ | $1.466324$ | $2.872044$ | $9.005220$ |

---
**12 потоков**
| $net size$      | 100                       | 300                       | 500                      | 1000                       | 
|-----------------|--------------------------|--------------------------|--------------------------|---------------------------|
| $blockSize = 1$ | $1.899723$ | $5.136733$ | $10.151457$ | $29.268799$ |
| $blockSize = 8$ | $0.272444$ | $1.172940$ | $2.664720$ | $10.791435$ |
| $blockSize = 16$ | $0.381391$ | $1.156489$ | $2.815086$ | $10.533287$ |
| $blockSize = 32$ | $0.529904$ | $1.600815$ | $3.402672$ | $9.755658$ |
| $blockSize = 64$ | $0.525305$ | $1.979355$ | $3.588561$ | $10.764794$ |

---
Выводы для функций (2) и (3) можно посмотреть [тут](https://docs.google.com/spreadsheets/d/1N0n9Vwj2sFep2Y9-y4HoBjZnocVhkLqfu4F9Dy3z8S0/edit?usp=sharing). 

## Анализирование результатов

В получившихся результатах мы не можем точно сказать, что алгоритм с каким-то одним размером блока и размером сетки **всегда** будет работать быстрее, чем с другим. Данная гипотеза сохраняется и в случае разного количества потоков — мы **не можем** точно сказать оптимальные размеры блока и размеры сетки.

Также по результатам можно отметить, что кроме случая с `размером блока=1` и `размером сетки=100` алгоритм **всегда** работает быстрее в случае нескольких потоков. Однако при увеличении количества потоков, скорость алгоритма возрастает **не всегда**. Как мне кажется, это свяно с затратами на управление и переключение потоков операционной системой и с динамическим изменением вычислительной нагрузки в ходе вычислений в волновом алгоритме.

**Вывод**: Размер блока, размер сетки и количество потоков для каждой функции нужно подбирать индивидуально. Так мы сможем добиться самых быстрых вычислений.
